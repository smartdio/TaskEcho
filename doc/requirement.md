### TaskEcho 最终需求说明（纯文本版·v1.0）

#### 总体定位
- 单用户本地应用，无登录页，启动即用
- 100% 数据由外部客户端通过 RESTful API 推送
- 用户界面完全只读（唯一可交互点是任务详情页底部的"回复"输入框）
- 不提供任何手动创建、编辑、删除项目、任务队列或任务的功能
- 数据层级结构：项目 -> 任务队列 -> 任务（一个项目包含多个任务队列，每个任务队列包含多个任务）

#### 技术栈
- 开发语言：JavaScript（不使用 TypeScript）
- 全栈框架：Next.js（使用 App Router 架构）
- 前后端统一使用 Node.js
- 前端框架：React（Next.js Server Components）
- UI 组件库：shadcn/ui
- 样式方案：Tailwind CSS
- 数据存储：MongoDB（使用 Mongoose ODM）

#### 数据入口（唯一核心接口）
一个接口完成项目、任务队列与批量任务的创建/全量更新：
- 接口：POST /api/v1/submit
- 认证方式：项目专属 API Key（Header）
- 请求体包含：
  - project_id（外部唯一标识，必填）
  - project_name（显示名称）
  - queue_id（任务队列外部唯一标识，必填）
  - queue_name（任务队列显示名称）
  - tasks 数组（批量任务）
    - 每个任务包含：task_id（外部唯一标识，必填）、title、tags（数组）、status（pending|done|error）、messages（完整的对话历史数组）
- 行为规则（完全幂等）：
  - 根据 project_id 判断项目是否存在 → 不存在则创建，存在则更新项目名称
  - 根据 project_id + queue_id 判断任务队列是否存在 → 不存在则创建，存在则更新任务队列名称
  - 根据 project_id + queue_id + task_id 判断任务是否存在 → 不存在则创建，存在则完全替换该任务的所有字段（标题、标签、状态、对话历史）

#### 增量更新接口（可选，轻量）
- 追加单条对话消息（不覆盖历史，需指定 project_id + queue_id + task_id）
- 追加任务执行日志（纯文本，自动带时间戳，需指定 project_id + queue_id + task_id）
- 仅修改任务状态（需指定 project_id + queue_id + task_id）

#### UI 展示层级与核心内容
1. 首页
   - 项目列表，按最后任务更新时间倒序排列
   - 全局统计：总任务数 / Pending / Done / Error

2. 项目详情页（点击项目进入）
   - 单个项目下所有任务队列垂直列表
   - 每个任务队列显示：队列名称 + 任务数量统计（总数/Pending/Done/Error） + 最后更新时间
   - 支持按任务队列名称搜索

3. 任务队列详情页（点击任务队列进入）
   - 单个任务队列下所有任务垂直列表
   - 每条任务显示：标题 + 标签（多标签彩色展示） + 状态徽章 + 最后更新时间
   - 支持按标签过滤、按状态过滤

4. 任务详情页（点击任务进入）
   - 完整对话流程（用户 ↔ AI 多轮），支持 Markdown 渲染和代码高亮
   - 下方独立日志区（倒序展示所有推送的日志）
   - 页面底部始终保留一个回复输入框 + 发送按钮
     - 发送后仅在本地追加一条 user 消息，不触发任何外部执行（留给外部系统轮询发现）

#### 其他要求
- 深浅色模式自动适配系统
- 完全响应式布局（手机、平板、桌面均流畅）
- 数据存储使用 MongoDB 文档数据库
- 系统提供API key 的管理, 用户可以添加、删除、编辑API key

以上为完整且最终的需求范围，后续所有讨论均以此为准，不涉及任何代码实现细节。